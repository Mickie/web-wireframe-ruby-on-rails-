<div class="post" id="post_<%= aPost.id %>">
  <div class="post_votes">
    <div class="vote_up">
      <% if aPostVote && aPostVote.up_vote %>
        <i class="icon-thumbs-up icon-white disabled"></i>
      <% else %>
        <%= render partial: "partials/buttons/post_up_vote", locals: { aPost: aPost } %>
      <% end %>      
    </div>
    <div class="fan_score"><%= aPost.fan_score %></div>
    <div class="vote_down">
      <%= render partial: "partials/buttons/post_down_vote", locals: { aPost: aPost } %>
    </div>
  </div>

  <div class="profile_pic">
    <% if aPost.user.image %>
      <%= image_tag( aPost.user.image, size:"32x32" ) %>
    <% end %>
  </div>
  
  <div class="post_content">
    <div>
      <span class="user_name"><%= aPost.user.full_name %></span>
      <span class="timestamp"> - <%= time_ago_in_words(aPost.created_at) %> ago</span>
    </div>
    <div class="post_media">
      <% if aPost.image_url %>
        <div class="post_image">
          <img src="<%= aPost.image_url -%>" width="306" height="306" />
        </div>
      <% end %>
    </div>
    <p><%= raw handleNewlinesAndUrls( aPost.content ) %></p>
  </div>

  <div class="post_comments" id="post_<%= aPost.id %>_comments">
    <% aPost.comments.visible.each do |aComment| %>
      <% if user_signed_in? %>
        <% theCommentVote = current_user.user_comment_votes.find_by_comment_id(aComment.id) %>
        <% if theCommentVote && !theCommentVote.up_vote %>
          <% next %>
        <% end %>
      <% end %>
      <%= render partial: "partials/comment", locals: { aComment: aComment, aCommentVote: theCommentVote } %>
    <% end %>
  </div>
  
  <div class="post_comment_form">
    <div class="profile_pic">
      <% if user_signed_in? %>
        <%= image_tag( current_user.image, size:"32x32" ) %>
      <% end %>
    </div>
    <%= render "/comments/form", post:aPost, comment:aPost.comments.build %>
  </div>
</div>
