<%= provide(:title, "My Profile" ) %>

<div id="userShow">
  <div class="row-fluid">
    <div class="span12">
      <h1>The Parking Lot</h1>
    </div>
  </div>
  
  <% if @user.tailgates.length == 0 %>
    <div class="row-fluid">
      <div class="span12">
        <h2><%= link_to "Start Your Own Tailgate >>", new_tailgate_path, class: "btn btn-large btn-primary" %></h2>
      </div>
    </div>
  <% end %>
  
  <div class="row-fluid">
    <div class="span12">
      <div id="myAddTeamModal" class="modal hide fade" style="display: none;">
        <div class="modal-header">
          <a class="close" data-dismiss="modal">×</a>
          <h3>Add a team:</h3>
        </div>
        <%= render :partial => 'partials/team_picker' %>
      </div>
    </div>
  </div>
  
  <div class="row-fluid">
    <div class="span12">
      <div id="myAddLocationModal" class="modal hide fade" style="display: none;">
        <div class="modal-header">
          <a class="close" data-dismiss="modal">×</a>
          <h3>Add a location:</h3>
        </div>
        <%= form_for(@user_location, url: user_user_locations_path(@user, @user_location) ) do |f| %>
        <div class="modal-body">
          <%= render :partial => 'partials/location', :locals => { :f => f, :location => @user_location.location } %>
        </div>
        <div class="modal-footer">
          <%= f.submit("Add", id:"commit", class:"btn") %>
        </div>
        <% end %>
      </div>
    </div>
  </div>
  
  <div class="row-fluid">
    <div class="span4">
      <% if @user.tailgates.length > 0 %>
        <h3>My Tailgates</h3>
        <div class="well">
          <dl>
            <% @user.tailgates.each do |aTailgate|%>
              <dt><%= aTailgate.team.name %></dt>
              <dd><%= teamLogo(aTailgate.team, :small) %> <%= link_to aTailgate.name, tailgate_path(aTailgate)%></dd>
            <% end %>
          </dl>      
        </div>
        <%= link_to "Start Another Tailgate >>", new_tailgate_path, class: "btn" %>
      <% end %>
      <h3>My Teams</h3>
      <div class="well">
        <dl>
          <% @user.teams.each do |aTeam|%>
            <dt><%= aTeam.sport.name %></dt>
            <dd><%= teamLogo(aTeam, :small) %> <%= link_to aTeam.name, team_path(aTeam)%></dd>
          <% end %>
        </dl>      
      </div>
      <a href="#myAddTeamModal" data-toggle="modal" class="btn">Add Team</a>
      <h3>Trending Team Tailgates</h3>
      <div class="well">
        <dl>
          <% @user.teams.each do |aTeam|%>
            <dt><%= teamLogo(aTeam, :small) %> <%= aTeam.name %></dt>
            <% aTeam.tailgates do | aTailgate | %>
              <dd><%= link_to aTailgate.name, tailgate_path(aTailgate)%></dd>
            <% end %>
          <% end %>
        </dl>      
      </div>
    </div>
    <div class="span4">
      <h3>My Local Watch Sites</h3>
      <div class="well">
        <dl id="localWatchSiteList">
          <% @locationsWithTeamWatchSites.each do |aLocation|%>
            <dt><%= aLocation[:locationName] %></dt>
              <% aLocation[:localTeamWatchSiteList].each do |aWatchSite|%>
                <dd><%= link_to "#{aWatchSite.venue.name} - #{aWatchSite.team.name}", watch_site_path(aWatchSite)%></dd>
              <% end %>
          <% end %>
        </dl>      
      </div>
      <h3>My Local Tailgates</h3>
      <div class="well">
        <dl id="localTailgateList">
          <% @locationsWithTailgateVenues.each do |aLocation|%>
            <dt><%= aLocation[:locationName] %></dt>
              <% aLocation[:tailgateVenueList].each do |aTailgateVenue|%>
                <dd><%= link_to "#{aTailgateVenue.venue.name} - #{aTailgateVenue.tailgate.team.name}", tailgate_path(aTailgateVenue.tailgate)%></dd>
              <% end %>
          <% end %>
        </dl>      
      </div>
      <a href="#myAddLocationModal" data-toggle="modal" class="btn">Add Location</a>
    </div>
    <div class="span4">
      <h3>Other Local Watch Sites</h3>
      <div class="well">
        <dl>
          <% @localWatchSites.each do |aWatchSite|%>
            <dt><%= teamLogo(aWatchSite.team, :small) %> <%= aWatchSite.team.name %></dt>
            <dd><%= link_to aWatchSite.venue.name, venue_path(aWatchSite.venue)%></dd>
          <% end %>
        </dl>      
      </div>
    </div>
  </div>
</div>


